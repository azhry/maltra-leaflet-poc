<html>

<head>
    <title>Leaflet Maltra</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
        integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
        crossorigin="" />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
        integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
        crossorigin=""></script>

    <style>
        #map {
            width:100%;
            height:100%;
            padding:0px !important;
            margin:0px !important;
        }

        .popup-fixed {
            position: fixed;
            top: 30% !important;
            left: 5% !important;
            transform: none !important;
            margin: 0;
            border-radius: 0;
        }

        .leaflet-popup-tip-container {
            display: none;
        }
        
        .leaflet-popup-content-wrapper {
            border-radius: 0;
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <script>
        // pk.eyJ1IjoiYXpoYXJ5YXJsaWFuc3lhaCIsImEiOiJjbDI4N3F0YnowNmxlM2NwYWlsb3BwZWFpIn0.dB7uA6TXU4CdKV4M1z4PfQ
        // sk.eyJ1IjoiYXpoYXJ5YXJsaWFuc3lhaCIsImEiOiJjbDI4N3gwcTYwNHViM2tvODhrcmtwM2hqIn0.0_-Mi2gg5uPtKwy3v0dBLA
        const coord = [-5.655118, 132.741714];
        const map = L.map('map').setView(coord, 14);
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
            maxZoom: 18,
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1,
            accessToken: 'pk.eyJ1IjoiYXpoYXJ5YXJsaWFuc3lhaCIsImEiOiJjbDI4N3F0YnowNmxlM2NwYWlsb3BwZWFpIn0.dB7uA6TXU4CdKV4M1z4PfQ'
        }).addTo(map);

        const pane = map.createPane('fixed', document.getElementById('map'));

        let groups = {};

        function addCircleCoordinate(coord, radius, color, label, group) {
            const marker = L.marker(coord);
            const circle = L.circle(coord, {
                color: 'green',
                fillColor: color,
                fillOpacity: 0.5,
                radius: radius
            }).addTo(map);
            if (!groups[group]) {
                groups[group] = L.layerGroup();
            }

            const popup = L.popup({
                pane: 'fixed',
                className: 'popup-fixed',
                autoPan: false,
            }).setContent(`
                <strong>${label}</strong> (${group})
            `);
            marker.bindPopup(popup);

            marker.addTo(groups[group]);
            circle.addTo(groups[group]);
        }

        addCircleCoordinate(coord, 500, '#f03', 'Lokasi Z', 'Perguruan Tinggi');

        const data = [
            {
                label: 'Lokasi A',
                coord: [-5.654133, 132.747773],
                color: '#f03',
                radius: 400,
                group: 'Kantor'
            },
            {
                label: 'Lokasi B',
                coord: [-5.649283, 132.734625],
                color: '#03f',
                radius: 300,
                group: 'Rumah Sakit'
            },
            {
                label: 'Lokasi C',
                coord: [-5.644433, 132.736888],
                color: '#3f0',
                radius: 700,
                group: 'Kantor'
            },
        ];

        data.forEach((row) => addCircleCoordinate(row.coord, row.radius, row.color, row.label, row.group));
        Object.keys(groups).forEach((group) => groups[group].addTo(map));

        const layerControl = L.control.layers({}, groups, { collapsed: false }).addTo(map);
    </script>
</body>

</html>